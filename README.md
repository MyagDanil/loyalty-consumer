<h1 align="center">Hi there, I'm <a href="https://daniilshat.ru/" target="_blank">Daniil</a> 
<img src="https://github.com/blackcater/blackcater/raw/main/images/Hi.gif" height="32"/></h1>
<h3 align="center">Computer science student, IT news writer from Russia üá∑üá∫</h3>

Loyalty Consumer
–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏.
–°–µ—Ä–≤–∏—Å —á–∏—Ç–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ Kafka, –∞—Ç–æ–º–∞—Ä–Ω–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∏—Ö –≤ PostgreSQL, –æ–±–Ω–æ–≤–ª—è–µ—Ç –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∫–µ—à–∏—Ä—É–µ—Ç –µ–≥–æ –≤ Redis –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —á—Ç–µ–Ω–∏–π.

–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
–ö–æ–Ω—Å—å—é–º–µ—Ä Kafka (–Ω–∞ Go, –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ sarama) —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π consumer groups –∏ —Ä—É—á–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º offset‚Äô–∞–º–∏.
–ê—Ç–æ–º–∞—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ PostgreSQL (begin / commit / rollback) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º pgx/pgxpool.
–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ Redis –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —á—Ç–µ–Ω–∏—è –∏ —Å–Ω–∏–∂–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –±–∞–∑—É.
–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ go-playground/validator (enterprise-–ø–æ–¥—Ö–æ–¥).
–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON (logrus), —É–¥–æ–±–Ω–æ–µ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å ELK / Loki.
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Docker, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ Docker Compose.

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞: —á—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ—ë–≤ (handler, store, cache, kafka, config).
–£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –±–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∑–∞—â–∏—Ç–∞ –æ—Ç —Ç–∏–ø–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫ –∏–∑ OWASP TOP‚Äë10, –±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
–°–µ—Ä–≤–∏—Å –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–º—É –ø–æ–¥—Ö–æ–¥—É –∏ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–ª–æ—ë–≤:
cmd/consumer ‚Äì —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –ª–æ–≥–≥–µ—Ä–∞, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ PostgreSQL/Redis/Kafka, –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Å—å—é–º–µ—Ä–∞ —Å graceful shutdown.
internal/handler ‚Äì –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π:
–ø–∞—Ä—Å–∏–Ω–≥ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è JSON-—Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É Transaction;

–æ—Ç–∫—Ä—ã—Ç–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –ë–î;
–≤—Å—Ç–∞–≤–∫–∞ –∑–∞–ø–∏—Å–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞;
commit –∏–ª–∏ rollback;

–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–µ—à–∞ –≤ Redis.
internal/models ‚Äì DTO/–º–æ–¥–µ–ª–∏ –¥–æ–º–µ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Transaction) —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ validator –∏ JSON-—Ç–µ–≥–∞–º–∏.
internal/store ‚Äì —Å–ª–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º PostgreSQL (insert/update/select, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏).
internal/cache ‚Äì –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ Redis –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–µ—à–µ–º –±–∞–ª–∞–Ω—Å–æ–≤.
internal/kafka ‚Äì –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ Kafka Consumer Group (sarama), –¥–µ–ª–µ–≥–∏—Ä—É—é—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –≤ handler.
internal/config ‚Äì –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–≥–µ—Ä–∞.

–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ —É–ø—Ä–æ—â–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞.

–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
–Ø–∑—ã–∫: Go (Golang)
–°–æ–æ–±—â–µ–Ω–∏—è: Kafka (consumer group, offset management)
–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö: PostgreSQL
–ö–µ—à: Redis
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è: Docker / Docker Compose
–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: logrus (JSON-—Ñ–æ—Ä–º–∞—Ç)
–í–∞–ª–∏–¥–∞—Ü–∏—è: go-playground/validator
–ö–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Ä—Å–∏–π: Git

–ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
Go (–±–µ—Ä–∏—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é, –Ω–∞–ø—Ä–∏–º–µ—Ä 1.22+)

Docker –∏ Docker Compose

–ó–∞–ø—É—â–µ–Ω–Ω—ã–µ —ç–∫–∑–µ–º–ø–ª—è—Ä—ã Kafka, PostgreSQL –∏ Redis (–º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ docker-compose.yml –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)

–®–∞–≥–∏

# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/youruser/loyalty-consumer.git
cd loyalty-consumer

# –ü–æ–¥–Ω–∏–º–∞–µ–º –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É (Postgres, Redis, Kafka)
docker compose up -d

# –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∞–∑–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
export POSTGRES_DSN="postgres://user:pass@localhost:5432/loyalty?sslmode=disable"
export REDIS_ADDR="localhost:6379"
export KAFKA_BROKERS="localhost:9092"
export KAFKA_GROUP_ID="loyalty-consumer-group"
export KAFKA_TOPIC="loyalty-transactions"
export LOG_LEVEL="info"

# –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–∏—Å
go run ./cmd/consumer
–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
–û–∂–∏–¥–∞–µ—Ç—Å—è, —á—Ç–æ –≤ Kafka-—Ç–æ–ø–∏–∫–µ loyalty-transactions –ª–µ–∂–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ JSON:

json
{
  "id": "uuid-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏",
  "user_id": "uuid-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
  "amount": 100,
  "type": "purchase",
  "created_at": "2025-12-04T10:00:00Z"
}
–ü–∞–π–ø–ª–∞–π–Ω –æ–±—Ä–∞–±–æ—Ç–∫–∏:
Consumer —á–∏—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ Kafka.
Handler –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç JSON –≤ models.Transaction –∏ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ.
–û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –≤ PostgreSQL:
—Å–æ–∑–¥–∞—ë—Ç—Å—è –∑–∞–ø–∏—Å—å –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏;
–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è COMMIT –∏–ª–∏ ROLLBACK –ø—Ä–∏ –æ—à–∏–±–∫–µ.
–í –≥–æ—Ä—É—Ç–∏–Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –∏–∑ –ë–î –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ Redis –∫–∞–∫ –∫–µ—à.
–û—à–∏–±–∫–∏ Redis –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Å–Ω–æ–≤–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É: –ë–î —è–≤–ª—è–µ—Ç—Å—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏—Å—Ç–∏–Ω—ã, –∫–µ—à ‚Äì —É—Å–∫–æ—Ä–µ–Ω–∏–µ.

–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–≤ —Ç–æ–º —á–∏—Å–ª–µ —Ç–∏–ø–æ–≤ –∏ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –∑–Ω–∞—á–µ–Ω–∏–π), —á—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å —á–∞—Å—Ç–∏ –ø—Ä–æ–±–ª–µ–º –∏–∑ OWASP TOP‚Äë10 (–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∏ —Ç.–¥.).
–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Å—Ç—Ä–æ–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –∫—Ä–µ–¥—ã) —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∞ –Ω–µ –≤ –∫–æ–¥–µ.
–õ–æ–≥–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤, —Ç–æ–ª—å–∫–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –∏ –±–∏–∑–Ω–µ—Å-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (ID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, userID, —Å—Ç–∞—Ç—É—Å—ã –æ–ø–µ—Ä–∞—Ü–∏–π).
–í REST‚Äë –∏ –¥—Ä—É–≥–∏—Ö –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö (–µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è) –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è JWT –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤.

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
Unit‚Äë—Ç–µ—Å—Ç—ã –¥–ª—è:
models.Transaction.Validate();
–º–µ—Ç–æ–¥–æ–≤ store (insert/update/select) —Å –º–æ–∫–∞–º–∏;
cache-—Å–ª–æ—è.

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:
–ø–æ–ª–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ Kafka —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∑–∞–ø–∏—Å–∏ –≤ –ë–î –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–µ—à–∞ –≤ Redis (—á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã–π Docker Compose).
–í–æ–∑–º–æ–∂–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ REST API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –∏ –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.
–ú–µ—Ç—Ä–∏–∫–∏ Prometheus (–∫–æ–ª-–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π, –æ—à–∏–±–∫–∞/—É—Å–ø–µ—Ö, latency).
–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å—Ö–µ–º—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (—Ç–∏–ø—ã –æ–ø–µ—Ä–∞—Ü–∏–π, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã).
–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–æ–ø–∏–∫–æ–≤ –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –ø–æ —Ç–∏–ø–∞–º.
